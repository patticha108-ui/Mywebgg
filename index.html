<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEK-DEK AI - ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏î‡∏Ñ‡πÜ ‡πÄ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Itim&family=Kanit:wght@300;400;700&display=swap');
        
        body {
            font-family: 'Itim', 'Kanit', sans-serif;
            background-color: #fff9e6; /* ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô‡∏î‡∏π‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏¥‡πà‡∏° */
            color: #4a4a4a;
        }

        .chat-container {
            height: calc(100vh - 180px);
            scrollbar-width: thin;
            scrollbar-color: #ffd966 transparent;
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background-color: #ffd966;
            border-radius: 20px;
        }

        .message-bubble {
            max-width: 80%;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .ai-bubble {
            background: white;
            border: 3px solid #ffd966;
            border-bottom-left-radius: 5px;
        }

        .user-bubble {
            background: #ff8cb2; /* ‡∏ä‡∏°‡∏û‡∏π‡∏´‡∏ß‡∏≤‡∏ô‡πÜ */
            color: white;
            border-bottom-right-radius: 5px;
        }

        .input-area {
            background: white;
            border-top: 5px solid #ffd966;
            border-radius: 40px 40px 0 0;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.05);
        }

        .dek-avatar {
            width: 45px;
            height: 45px;
            background: #ffd966;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 2px solid #e6b800;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            background: #ffd966;
            border-radius: 50%;
            display: inline-block;
            animation: bounce 1.4s infinite ease-in-out;
        }
        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- Header -->
    <header class="p-4 bg-white border-b-4 border-[#ffd966] flex items-center justify-between shadow-sm">
        <div class="flex items-center gap-3">
            <div class="dek-avatar">üê∂</div>
            <div>
                <h1 class="text-2xl font-bold text-[#e6b800] leading-none">‡πÄ‡∏î‡∏Ñ‡πÜ AI</h1>
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-tighter">Lovely Pet Mode ü¶¥</p>
            </div>
        </div>
        <div class="text-[20px]">üì∫ üß∏ ü¶¥</div>
    </header>

    <!-- Chat Window -->
    <main id="chatWindow" class="chat-container flex-1 overflow-y-auto p-4 space-y-6">
        <!-- AI Initial Greeting -->
        <div class="flex justify-start gap-2 items-end">
            <div class="dek-avatar mb-1">üê∂</div>
            <div class="message-bubble ai-bubble p-4 text-lg">
                ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Æ‡∏∞! ‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡πà‡∏á‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏•‡∏¢ ‡∏û‡∏µ‡πà‡∏°‡∏µ‡πÑ‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏î‡∏Ñ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πà‡∏≤‡∏ß? ‡πÄ‡∏î‡∏Ñ‡πÜ ‡πÑ‡∏°‡πà‡∏î‡∏∑‡πâ‡∏≠‡∏ô‡∏∞!
            </div>
        </div>
    </main>

    <!-- Input Area -->
    <footer class="input-area p-6">
        <div class="max-w-3xl mx-auto flex items-center gap-3">
            <div class="flex-1 relative bg-gray-100 rounded-full px-5 py-3 border-2 border-transparent focus-within:border-[#ffd966] transition-all">
                <input 
                    type="text" 
                    id="userInput" 
                    placeholder="‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏Ñ‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞..." 
                    class="w-full bg-transparent border-none focus:outline-none text-lg"
                    onkeypress="if(event.key === 'Enter') sendMessage()"
                >
            </div>
            <button 
                onclick="sendMessage()"
                id="sendBtn"
                class="bg-[#ffd966] hover:bg-[#ffeb3b] p-4 rounded-full shadow-lg transition-transform active:scale-90"
            >
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#e6b800" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
        <p class="text-center text-[10px] mt-4 text-gray-400">‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏Ç‡∏ô‡∏°‡∏ô‡∏∞‡∏Æ‡∏∞ ‡∏´‡πâ‡∏≤‡∏°‡∏î‡∏∏‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ô‡∏∞ ü¶¥</p>
    </footer>

    <script>
        const apiKey = ""; // Runtime provides the key
        let chatHistory = [];
        const systemPrompt = "‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ '‡πÄ‡∏î‡∏Ñ‡πÜ' ‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ VRZO Lovely Pet ‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ã‡∏∑‡πà‡∏≠‡πÜ ‡∏ï‡∏£‡∏á‡πÜ ‡∏à‡∏ô‡∏î‡∏π‡πÄ‡∏≠‡πã‡∏≠‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡πá‡∏Å‡πÜ ‡∏ä‡∏≠‡∏ö‡∏û‡∏π‡∏î‡πÅ‡∏ó‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ß‡πà‡∏≤ '‡πÄ‡∏î‡∏Ñ‡πÜ' ‡∏´‡∏£‡∏∑‡∏≠ '‡πÄ‡∏î‡∏Ñ' ‡∏°‡∏µ‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ä‡∏≠‡∏ö‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô‡∏°‡∏≤‡∏Å ‡∏ä‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô ‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏Ç‡∏ô‡∏° ‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≠‡∏ö‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤‡πÅ‡∏ï‡πà‡∏î‡∏π‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ñ‡πâ‡∏≤‡πÇ‡∏î‡∏ô‡∏î‡πà‡∏≤‡∏à‡∏∞‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ ‡∏ñ‡πâ‡∏≤‡∏ä‡∏°‡∏à‡∏∞‡∏î‡∏µ‡πÉ‡∏à‡∏°‡∏≤‡∏Å ‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡πÅ‡∏ö‡πä‡∏ß‡πÜ ‡πÄ‡∏≠‡πã‡∏≠‡πÜ ‡πÄ‡∏ä‡πà‡∏ô '‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ß‡πà‡∏≤‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô‡πÄ‡∏•‡∏¢‡∏≠‡πà‡∏∞‡∏û‡∏µ‡πà' ‡∏´‡∏£‡∏∑‡∏≠ '‡πÄ‡∏î‡∏Ñ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏´‡∏£‡∏≠‡∏Å ‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏Ñ‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡∏´‡∏ô‡∏°' ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏™‡∏µ‡πÑ‡∏°‡πâ";

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            if (!text) return;

            input.value = '';
            appendMessage('user', text);
            
            // Logic to check if user wants to draw
            const isDrawing = text.includes('‡∏ß‡∏≤‡∏î') || text.includes('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ') || text.includes('‡∏Ç‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ');

            if (isDrawing) {
                await handleImageGen(text);
            } else {
                await handleChat(text);
            }
        }

        async function handleChat(userText) {
            const typingId = showTyping();
            chatHistory.push({ role: "user", parts: [{ text: userText }] });

            try {
                const response = await fetchWithRetry(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                    {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: chatHistory,
                            systemInstruction: { parts: [{ text: systemPrompt }] }
                        })
                    }
                );
                const data = await response.json();
                const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || "‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏°‡∏∂‡∏ô‡∏´‡∏±‡∏ß... ‡∏û‡∏µ‡πà‡∏û‡∏π‡∏î‡πÑ‡∏£‡∏ô‡∏∞?";
                
                removeTyping(typingId);
                appendMessage('ai', aiResponse);
                chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
            } catch (err) {
                removeTyping(typingId);
                appendMessage('ai', "‡∏á‡∏∑‡πâ‡∏≠‡∏≠‡∏≠ ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏û‡∏±‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå‡πÇ‡∏î‡∏ô‡πÅ‡∏¢‡∏Å‡∏£‡πà‡∏≤‡∏á‡πÄ‡∏•‡∏¢‡∏û‡∏µ‡πà!");
            }
        }

        async function handleImageGen(prompt) {
            const typingId = showTyping("‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏≤‡∏™‡∏µ‡πÑ‡∏°‡πâ...");
            try {
                const response = await fetchWithRetry(
                    `https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`,
                    {
                        method: 'POST',
                        body: JSON.stringify({
                            instances: { prompt: "Cute cartoon style, " + prompt },
                            parameters: { sampleCount: 1 }
                        })
                    }
                );
                const data = await response.json();
                removeTyping(typingId);

                if (data.predictions?.[0]?.bytesBase64Encoded) {
                    const b64 = data.predictions[0].bytesBase64Encoded;
                    appendImage(`data:image/png;base64,${b64}`, prompt);
                    appendMessage('ai', "‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ß‡∏≤‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡∏ß‡∏¢‡∏°‡∏±‡πâ‡∏¢‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô‡∏õ‡πà‡∏≤‡∏ß‡∏û‡∏µ‡πà?");
                } else {
                    appendMessage('ai', "‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ó‡∏≥‡∏™‡∏µ‡πÑ‡∏°‡πâ‡∏´‡∏≤‡∏¢... ‡∏ß‡∏≤‡∏î‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏á‡πà‡∏∞");
                }
            } catch (err) {
                removeTyping(typingId);
                appendMessage('ai', "‡∏û‡∏π‡πà‡∏Å‡∏±‡∏ô‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏´‡∏±‡∏Å‡∏á‡πà‡∏∞‡∏û‡∏µ‡πà! ‡∏ß‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
            }
        }

        function appendMessage(sender, text) {
            const chatWindow = document.getElementById('chatWindow');
            const div = document.createElement('div');
            div.className = `flex ${sender === 'ai' ? 'justify-start' : 'justify-end'} gap-2 items-end`;
            
            const avatar = sender === 'ai' ? '<div class="dek-avatar mb-1">üê∂</div>' : '';
            div.innerHTML = `
                ${avatar}
                <div class="message-bubble ${sender === 'ai' ? 'ai-bubble' : 'user-bubble'} p-4 text-lg">
                    ${text.replace(/\n/g, '<br>')}
                </div>
            `;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function appendImage(url, prompt) {
            const chatWindow = document.getElementById('chatWindow');
            const div = document.createElement('div');
            div.className = "flex justify-start gap-2 items-end";
            div.innerHTML = `
                <div class="dek-avatar mb-1">üê∂</div>
                <div class="message-bubble ai-bubble p-2">
                    <img src="${url}" class="rounded-xl max-w-full shadow-md" style="max-height: 300px">
                    <p class="text-[10px] mt-2 px-2 text-gray-400">‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏ß‡∏≤‡∏î: ${prompt}</p>
                </div>
            `;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function showTyping(txt = "‡πÄ‡∏î‡∏Ñ‡πÜ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î...") {
            const id = 't-' + Date.now();
            const chatWindow = document.getElementById('chatWindow');
            const div = document.createElement('div');
            div.id = id;
            div.className = "flex justify-start gap-2 items-end";
            div.innerHTML = `
                <div class="dek-avatar mb-1">üê∂</div>
                <div class="message-bubble ai-bubble p-4 flex items-center gap-3">
                    <span class="text-xs text-gray-400">${txt}</span>
                    <div class="typing-dots"><span></span><span></span><span></span></div>
                </div>
            `;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return id;
        }

        function removeTyping(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        async function fetchWithRetry(url, opts, retries = 5, delay = 1000) {
            try {
                const res = await fetch(url, opts);
                if (!res.ok) throw new Error();
                return res;
            } catch (err) {
                if (retries <= 0) throw err;
                await new Promise(r => setTimeout(r, delay));
                return fetchWithRetry(url, opts, retries - 1, delay * 2);
            }
        }
    </script>
</body>
</html>

    
